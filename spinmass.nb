(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14768,        379]
NotebookOptionsPosition[     13975,        348]
NotebookOutlinePosition[     14361,        365]
CellTagsIndexPosition[     14318,        362]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_"}], 
    "]"}], " ", "=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x1", "-", "x2"}], ")"}], "^", "2"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"y1", "-", "y2"}], ")"}], "^", "2"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"z1", "-", "z2"}], ")"}], "^", "2"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lambda", " ", "=", " ", 
   RowBox[{"0.05", "*", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "3"}], ")"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQvcvTx7Hv8RvH5gNFeSDa46FTB4i+qOQPpvfN73oB
om//NHoNom3uf34Pon8EF38A0eqGDzT7gXSSwBtdEM3DJJ0MomP661JB9LLZ
DpkgetbMUDDdfGBWE4h2SrBsAdGaMf/PgGiXbo6zIDpox7k7IDpjouddEK18
u/MxiL7vvxJMTzikqjQBSL+rmQ2m1Q1dtED0npJ8ML3O/aIRiBaI+AqmHUwP
OUwAu1vZcQLYPvOFO4G01ZYUMD1DUWgh57M3jqKJ6YtA9LNmvXUgmmdrGZiO
y527BUSnvuPaCqIBHneroQ==
  "]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{Cell["\[Placeholder]"], 
  RowBox[{
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{
            "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
            "]"}], "*", "lambda"}], ")"}]}], "+", 
        RowBox[{"1", "/", 
         SuperscriptBox[
          RowBox[{"r", "[", 
           RowBox[{
           "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
           "]"}], "2"]}]}], ")"}], "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"r", "[", 
          RowBox[{
          "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
          "]"}]}], "/", "lambda"}], "]"}], "*", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{"z2", "-", "z1"}], ")"}], 
       RowBox[{"r", "[", 
        RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}],
         "]"}]]}], ",", 
     RowBox[{"{", 
      RowBox[{"x1", ",", 
       RowBox[{"-", "0.002"}], ",", "0.002"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y1", ",", 
       RowBox[{"-", "0.002"}], ",", "0.002"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z1", ",", 
       RowBox[{"-", "0.0045"}], ",", "0.0045"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2", ",", 
       RowBox[{"-", "0.005"}], ",", "0.005"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y2", ",", 
       RowBox[{"-", "0.005"}], ",", "0.005"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z2", ",", 
       RowBox[{"0.0045", "+", 
        RowBox[{"0.74", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "3"}]]}]}], ",", 
       RowBox[{"0.0045", "+", 
        RowBox[{"0.24", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "3"}]]}], "+", "0.02"}]}], "}"}]}], "]"}], "/", 
   RowBox[{"(", 
    RowBox[{"4", "*", "4", "*", "9", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "9"}]]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.877401521501*^9, 3.8774017424370003`*^9}, {
   3.87740178475*^9, 3.8774018216210003`*^9}, {3.877401939027*^9, 
   3.8774020995039997`*^9}, {3.8774021767349997`*^9, 3.877402202865*^9}, {
   3.877402766019*^9, 3.8774027827139997`*^9}, {3.8774034422200003`*^9, 
   3.877403445889*^9}, {3.877407038157*^9, 3.877407041443*^9}, {
   3.877407105836*^9, 3.877407115666*^9}, 3.877480765008*^9, {
   3.877489791157*^9, 3.877489805788*^9}, 3.87749010446*^9, {
   3.878098481141*^9, 3.878098481303*^9}}],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","slwcon",
   "\"\:6570\:503c\:79ef\:5206\:6536\:655b\:901f\:5ea6\:592a\:6162\:ff1b\:53ef\
\:80fd\:662f\:5982\:4e0b\:539f\:56e0\:ff1a\:5947\:70b9\:ff0c\:79ef\:5206\:503c\
\:662f 0\:ff0c\:9ad8\:5ea6\:632f\:8361\:7684\:88ab\:79ef\:51fd\:6570\:ff0c\
\:6216\:8005 WorkingPrecision \:592a\:5c0f.\"",2,6,1,32080645164751474430,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.8774023363529997`*^9, 3.877402412532*^9, 3.877402461064*^9, 
   3.877402505531*^9, 3.8774027769630003`*^9, {3.877402981007*^9, 
   3.877403017495*^9}, 3.877403618131*^9, {3.877403676722*^9, 
   3.8774036987390003`*^9}, 3.877404303135*^9, 3.877404409262*^9, 
   3.877404449837*^9, 3.877404961532*^9, 3.877405021895*^9, 3.877405083051*^9,
    3.877405205185*^9, 3.877407132567*^9, 3.877489852934*^9, 
   3.877489896501*^9, 3.877489936323*^9, 3.877489995877*^9, 3.877490036693*^9,
    3.8774900757790003`*^9, 3.878098517198*^9, 3.878702359430601*^9, 
   3.878702456124601*^9, 3.8787025101676006`*^9, 3.8789554577286005`*^9}],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","eincr",
   "\"\:7b56\:7565 GlobalAdaptive \:7684\:5168\:5c40\:8bef\:5dee\:5df2\:7ecf\
\:589e\:52a0\:4e86\:8d85\:8fc7 \\!\\(\\*RowBox[{\\\"2000\\\"}]\\) \:6b21. \
\:5728\:6570\:6b21\:8ba1\:7b97\:88ab\:79ef\:51fd\:6570\:540e\:ff0c\:5168\:5c40\
\:8bef\:5dee\:5e94\:8be5\:5355\:8c03\:9012\:51cf. \:53ef\:80fd\:662f\:5982\
\:4e0b\:539f\:56e0\:4e4b\:4e00\:ff1a\:5de5\:4f5c\:7cbe\:5ea6\:5bf9\:4e8e\:6307\
\:5b9a\:7684\:7cbe\:5ea6\:76ee\:6807\:662f\:4e0d\:8db3\:7684\:ff1b\:88ab\:79ef\
\:51fd\:6570\:9ad8\:5ea6\:632f\:8361\:6216\:8005\:5b83\:4e0d\:662f\:4e00\:4e2a\
\:ff08\:5206\:6bb5\:ff09\:5e73\:6ed1\:51fd\:6570\:ff1b\:6216\:8005\:79ef\:5206\
\:7684\:771f\:5b9e\:503c\:4e3a 0. \:589e\:52a0 GlobalAdaptive \:9009\:9879 \
MaxErrorIncreases \
\:7684\:503c\:53ef\:80fd\:4ea7\:751f\:4e00\:4e2a\:53d1\:6563\:7684\:6570\:503c\
\:79ef\:5206. \
\:5bf9\:4e8e\:79ef\:5206\:548c\:8bef\:5dee\:4f30\:8ba1\:ff0cNIntegrate \:5f97\
\:5230 \\!\\(\\*RowBox[{\\\"9.444641973475118`*^-20\\\"}]\\) \:548c \
\\!\\(\\*RowBox[{\\\"2.47582194397448`*^-21\\\"}]\\).\"",2,6,2,
   32080645164751474430,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.8774023363529997`*^9, 3.877402412532*^9, 3.877402461064*^9, 
   3.877402505531*^9, 3.8774027769630003`*^9, {3.877402981007*^9, 
   3.877403017495*^9}, 3.877403618131*^9, {3.877403676722*^9, 
   3.8774036987390003`*^9}, 3.877404303135*^9, 3.877404409262*^9, 
   3.877404449837*^9, 3.877404961532*^9, 3.877405021895*^9, 3.877405083051*^9,
    3.877405205185*^9, 3.877407132567*^9, 3.877489852934*^9, 
   3.877489896501*^9, 3.877489936323*^9, 3.877489995877*^9, 3.877490036693*^9,
    3.8774900757790003`*^9, 3.878098517198*^9, 3.878702359430601*^9, 
   3.878702456124601*^9, 3.8787025101676006`*^9, 3.878955469623601*^9}],

Cell[BoxData[
 RowBox[{"6.55877914824661`*^-13", " ", 
  InterpretationBox[Cell["\[Placeholder]"],
   TextCell["\[Placeholder]"]]}]], "Output",
 CellChangeTimes->{
  3.877402336356*^9, 3.877402412553*^9, 3.877402461083*^9, 3.877402505547*^9, 
   3.877402776981*^9, {3.877402981023*^9, 3.877403017533*^9}, 
   3.8774036181730003`*^9, {3.877403686525*^9, 3.877403698788*^9}, 
   3.877404303174*^9, 3.87740440931*^9, 3.877404459851*^9, 3.877404961571*^9, 
   3.8774050316610003`*^9, 3.8774050938459997`*^9, 3.877405205227*^9, 
   3.877407132605*^9, 3.877489852975*^9, 3.877489896539*^9, 3.877489946477*^9,
    3.877490006049*^9, 3.877490046835*^9, 3.8774900858900003`*^9, 
   3.878098527892*^9, 3.878702369873601*^9, 3.878702471043601*^9, 
   3.878702522040601*^9, 3.8789554696266007`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NIntegrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"x1", ",", "y1", ",", "z1", ",", "0", ",", "0", ",", "0"}], 
          "]"}], "*", "lambda"}], ")"}]}], "+", 
      RowBox[{"1", "/", 
       SuperscriptBox[
        RowBox[{"r", "[", 
         RowBox[{"x1", ",", "y1", ",", "z1", ",", "0", ",", "0", ",", "0"}], 
         "]"}], "2"]}]}], ")"}], "*", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"r", "[", 
        RowBox[{"x1", ",", "y1", ",", "z1", ",", "0", ",", "0", ",", "0"}], 
        "]"}]}], "/", "lambda"}], "]"}], "*", 
    FractionBox["z1", 
     RowBox[{"r", "[", 
      RowBox[{"x1", ",", "y1", ",", "z1", ",", "0", ",", "0", ",", "0"}], 
      "]"}]]}], ",", 
   RowBox[{"{", 
    RowBox[{"x1", ",", 
     RowBox[{"-", "0.005"}], ",", "0.005"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y1", ",", 
     RowBox[{"-", "0.005"}], ",", "0.005"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z1", ",", "0.00003", ",", 
     RowBox[{"0.00003", "+", "0.02"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.877403963333*^9, 3.877404077821*^9}, {3.877480862976*^9,
   3.877480966676*^9}, {3.877489787678*^9, 3.8774898374639997`*^9}, {
  3.877489883773*^9, 3.877489884052*^9}, {3.8774899877349997`*^9, 
  3.877489990429*^9}, {3.877490029229*^9, 3.877490031252*^9}, {
  3.8774900650220003`*^9, 3.877490069933*^9}, {3.877490115224*^9, 
  3.877490117446*^9}, {3.878955594338601*^9, 3.8789555971676006`*^9}}],

Cell[BoxData["0.0001724142604916848`"], "Output",
 CellChangeTimes->{3.877404087198*^9, 3.877404303335*^9, 
  3.8774044097860003`*^9, 3.8774044607530003`*^9, 3.877404961719*^9, 
  3.877405032832*^9, 3.87740509488*^9, 3.877405205373*^9, 3.877489853082*^9, 
  3.877489897076*^9, 3.877489947959*^9, 3.877490007288*^9, 
  3.8774900477460003`*^9, 3.87749008695*^9, 3.8774901203450003`*^9, 
  3.878098529164*^9, 3.878702371152601*^9, 3.8787024722386007`*^9, 
  3.878702523142601*^9, 3.878955470815601*^9, 3.878955599940601*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{
           "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
           "]"}], "*", "lambda"}], ")"}]}], "+", 
       RowBox[{"1", "/", 
        SuperscriptBox[
         RowBox[{"r", "[", 
          RowBox[{
          "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
          "]"}], "2"]}]}], ")"}], "*", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"r", "[", 
         RowBox[{
         "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
         "]"}]}], "/", "lambda"}], "]"}], "*", 
     FractionBox["z1", 
      RowBox[{"r", "[", 
       RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
       "]"}]]}], ",", 
    RowBox[{"{", 
     RowBox[{"x1", ",", 
      RowBox[{"-", "0.005"}], ",", "0.005"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y1", ",", 
      RowBox[{"-", "0.005"}], ",", "0.005"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"z1", ",", "0.00003", ",", 
      RowBox[{"0.00003", "+", "0.02"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x2", ",", 
      RowBox[{"-", "0.0001"}], ",", "0.0001"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y2", ",", 
      RowBox[{"-", "0.00005"}], ",", "0.00005"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"z2", ",", 
      RowBox[{"-", "0.00005"}], ",", "0.00005"}], "}"}]}], "]"}], "/", 
  RowBox[{"(", 
   RowBox[{"2", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "12"}]]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.8789552201856008`*^9, 3.8789552717586007`*^9}, {
   3.8789553210966005`*^9, 3.8789554056296005`*^9}, 3.8789555291206007`*^9, {
   3.878955588241601*^9, 3.8789555911996007`*^9}}],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","slwcon",
   "\"\:6570\:503c\:79ef\:5206\:6536\:655b\:901f\:5ea6\:592a\:6162\:ff1b\:53ef\
\:80fd\:662f\:5982\:4e0b\:539f\:56e0\:ff1a\:5947\:70b9\:ff0c\:79ef\:5206\:503c\
\:662f 0\:ff0c\:9ad8\:5ea6\:632f\:8361\:7684\:88ab\:79ef\:51fd\:6570\:ff0c\
\:6216\:8005 WorkingPrecision \:592a\:5c0f.\"",2,12,5,32080645164751474430,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8789555469456005`*^9, 3.878955602432601*^9}],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","eincr",
   "\"\:7b56\:7565 GlobalAdaptive \:7684\:5168\:5c40\:8bef\:5dee\:5df2\:7ecf\
\:589e\:52a0\:4e86\:8d85\:8fc7 \\!\\(\\*RowBox[{\\\"2000\\\"}]\\) \:6b21. \
\:5728\:6570\:6b21\:8ba1\:7b97\:88ab\:79ef\:51fd\:6570\:540e\:ff0c\:5168\:5c40\
\:8bef\:5dee\:5e94\:8be5\:5355\:8c03\:9012\:51cf. \:53ef\:80fd\:662f\:5982\
\:4e0b\:539f\:56e0\:4e4b\:4e00\:ff1a\:5de5\:4f5c\:7cbe\:5ea6\:5bf9\:4e8e\:6307\
\:5b9a\:7684\:7cbe\:5ea6\:76ee\:6807\:662f\:4e0d\:8db3\:7684\:ff1b\:88ab\:79ef\
\:51fd\:6570\:9ad8\:5ea6\:632f\:8361\:6216\:8005\:5b83\:4e0d\:662f\:4e00\:4e2a\
\:ff08\:5206\:6bb5\:ff09\:5e73\:6ed1\:51fd\:6570\:ff1b\:6216\:8005\:79ef\:5206\
\:7684\:771f\:5b9e\:503c\:4e3a 0. \:589e\:52a0 GlobalAdaptive \:9009\:9879 \
MaxErrorIncreases \
\:7684\:503c\:53ef\:80fd\:4ea7\:751f\:4e00\:4e2a\:53d1\:6563\:7684\:6570\:503c\
\:79ef\:5206. \
\:5bf9\:4e8e\:79ef\:5206\:548c\:8bef\:5dee\:4f30\:8ba1\:ff0cNIntegrate \:5f97\
\:5230 \\!\\(\\*RowBox[{\\\"6.6665883147386`*^-16\\\"}]\\) \:548c \
\\!\\(\\*RowBox[{\\\"7.367621540127635`*^-16\\\"}]\\).\"",2,12,6,
   32080645164751474430,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8789555469456005`*^9, 3.878955609940601*^9}],

Cell[BoxData["0.00033332941573693`"], "Output",
 CellChangeTimes->{3.878955439335601*^9, 3.878955470869601*^9, 
  3.8789555659226007`*^9, 3.8789556099686007`*^9}]
}, Open  ]]
},
WindowSize->{1904, 998},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
Magnification:>1.4 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (2016\:5e7410\:67088\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1145, 33, 146, "Input"],
Cell[CellGroupData[{
Cell[1728, 57, 2584, 70, 138, "Input"],
Cell[4315, 129, 1064, 18, 28, "Message"],
Cell[5382, 149, 1807, 29, 67, "Message"],
Cell[7192, 180, 786, 13, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8015, 198, 1601, 41, 131, "Input"],
Cell[9619, 241, 521, 7, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10177, 253, 1897, 55, 138, "Input"],
Cell[12077, 310, 485, 9, 28, "Message"],
Cell[12565, 321, 1229, 20, 67, "Message"],
Cell[13797, 343, 162, 2, 43, "Output"]
}, Open  ]]
}
]
*)

